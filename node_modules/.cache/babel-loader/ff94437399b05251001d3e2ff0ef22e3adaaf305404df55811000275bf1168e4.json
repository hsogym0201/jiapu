{"ast":null,"code":"import \"core-js/modules/esnext.iterator.map.js\";\nimport * as echarts from \"echarts/core\";\nimport { SankeyChart } from \"echarts/charts\";\nimport { TitleComponent, TooltipComponent } from \"echarts/components\";\nimport { CanvasRenderer } from \"echarts/renderers\";\n\n// 注册必要的组件\necharts.use([SankeyChart, TitleComponent, TooltipComponent, CanvasRenderer]);\nexport default {\n  name: \"SangJiTu\",\n  props: {\n    sankeyData: Object // 从父组件传递过来的桑基图数据\n  },\n  watch: {\n    sankeyData(newData) {\n      if (newData && newData.nodes.length > 0) {\n        this.updateChart(newData); // 当数据变化时更新桑基图\n      }\n    }\n  },\n  mounted() {\n    this.initChart();\n  },\n  methods: {\n    initChart() {\n      const chartDom = document.getElementById(\"SangJiTU\");\n      this.myChart = echarts.init(chartDom);\n    },\n    // 更新桑基图\n    updateChart(sankeyData) {\n      // 定义每列（节点和连接）的颜色，节点颜色较深，连接颜色较淡\n      const nodeColors = [\"#b71c1c\", \"#388e3c\", \"#1976d2\", \"#fbc02d\"]; // 更深的颜色\n      const linkColors = [\"#e57373\", \"#81c784\", \"#64b5f6\", \"#fff176\"]; // 更淡的颜色\n\n      // 使用索引为节点和连接设置颜色\n      const nodesWithColors = sankeyData.nodes.map((node, index) => ({\n        ...node,\n        itemStyle: {\n          color: nodeColors[index % nodeColors.length] // 循环颜色\n        }\n      }));\n      const linksWithColors = sankeyData.links.map((link, index) => ({\n        ...link,\n        itemStyle: {\n          color: linkColors[index % linkColors.length],\n          // 循环颜色\n          opacity: 0.6 // 设置连接的透明度使其更淡\n        }\n      }));\n\n      // 图例标题（4列标题）\n      const columnTitles = [\"始祖原居地\", \"始祖迁居地\", \"始迁祖原居地\", \"始迁祖迁居地\"];\n\n      // 动态生成标题位置（x 坐标按比例分布）\n      const graphicElements = columnTitles.map((title, index) => ({\n        type: \"text\",\n        left: `${10 + index * 20}%`,\n        // 根据列的位置调整\n        top: \"5%\",\n        // 标题的位置\n        style: {\n          text: title,\n          fontSize: 16,\n          fontWeight: \"bold\",\n          fill: \"#333\" // 标题颜色\n        }\n      }));\n      const option = {\n        title: {\n          text: \"家族迁徙路径\",\n          left: \"center\"\n        },\n        tooltip: {\n          trigger: \"item\",\n          formatter: params => {\n            if (params.dataType === \"node\") {\n              return `节点: ${params.name}<br>类别: ${params.data.category}`;\n            }\n            return `从: ${params.data.source}<br>到: ${params.data.target}<br>值: ${params.data.value}`;\n          }\n        },\n        series: [{\n          type: \"sankey\",\n          data: sankeyData.nodes,\n          links: sankeyData.links,\n          emphasis: {\n            focus: \"adjacency\"\n          },\n          itemStyle: {\n            borderWidth: 0,\n            borderColor: \"#000\"\n          },\n          lineStyle: {\n            color: \"source\",\n            opacity: 0.6\n          },\n          layoutIterations: 64,\n          // 提高布局计算的次数，保证分布合理\n          nodeAlign: \"left\",\n          // 节点左对齐\n          levels: [{\n            depth: 0,\n            itemStyle: {\n              color: \"#b71c1c\"\n            }\n          }, {\n            depth: 1,\n            itemStyle: {\n              color: \"#388e3c\"\n            }\n          }, {\n            depth: 2,\n            itemStyle: {\n              color: \"#1976d2\"\n            }\n          }, {\n            depth: 3,\n            itemStyle: {\n              color: \"#fbc02d\"\n            }\n          }]\n        }],\n        graphic: [{\n          type: \"text\",\n          left: \"10%\",\n          top: \"5%\",\n          style: {\n            text: \"始祖原居地\",\n            fontSize: 16,\n            fontWeight: \"bold\"\n          }\n        }, {\n          type: \"text\",\n          left: \"30%\",\n          top: \"5%\",\n          style: {\n            text: \"始祖迁居地\",\n            fontSize: 16,\n            fontWeight: \"bold\"\n          }\n        }, {\n          type: \"text\",\n          left: \"50%\",\n          top: \"5%\",\n          style: {\n            text: \"始迁祖原居地\",\n            fontSize: 16,\n            fontWeight: \"bold\"\n          }\n        }, {\n          type: \"text\",\n          left: \"70%\",\n          top: \"5%\",\n          style: {\n            text: \"始迁祖迁居地\",\n            fontSize: 16,\n            fontWeight: \"bold\"\n          }\n        }]\n      };\n      this.myChart.setOption(option);\n    }\n  }\n};","map":{"version":3,"names":["echarts","SankeyChart","TitleComponent","TooltipComponent","CanvasRenderer","use","name","props","sankeyData","Object","watch","newData","nodes","length","updateChart","mounted","initChart","methods","chartDom","document","getElementById","myChart","init","nodeColors","linkColors","nodesWithColors","map","node","index","itemStyle","color","linksWithColors","links","link","opacity","columnTitles","graphicElements","title","type","left","top","style","text","fontSize","fontWeight","fill","option","tooltip","trigger","formatter","params","dataType","data","category","source","target","value","series","emphasis","focus","borderWidth","borderColor","lineStyle","layoutIterations","nodeAlign","levels","depth","graphic","setOption"],"sources":["D:\\project\\idea-project\\jiapudemo1\\jiapudemo1\\src\\components\\SangJiTu.vue"],"sourcesContent":["<template>\r\n  <div class=\"SangJiTu\">\r\n    <div id=\"SangJiTU\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from \"echarts/core\";\r\nimport { SankeyChart } from \"echarts/charts\";\r\nimport { TitleComponent, TooltipComponent } from \"echarts/components\";\r\nimport { CanvasRenderer } from \"echarts/renderers\";\r\n\r\n// 注册必要的组件\r\necharts.use([SankeyChart, TitleComponent, TooltipComponent, CanvasRenderer]);\r\n\r\nexport default {\r\n  name: \"SangJiTu\",\r\n  props: {\r\n    sankeyData: Object, // 从父组件传递过来的桑基图数据\r\n  },\r\n  watch: {\r\n    sankeyData(newData) {\r\n      if (newData && newData.nodes.length > 0) {\r\n        this.updateChart(newData); // 当数据变化时更新桑基图\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.initChart();\r\n  },\r\n  methods: {\r\n    initChart() {\r\n      const chartDom = document.getElementById(\"SangJiTU\");\r\n      this.myChart = echarts.init(chartDom);\r\n    },\r\n\r\n    // 更新桑基图\r\n    updateChart(sankeyData) {\r\n      // 定义每列（节点和连接）的颜色，节点颜色较深，连接颜色较淡\r\n      const nodeColors = [\"#b71c1c\", \"#388e3c\", \"#1976d2\", \"#fbc02d\"]; // 更深的颜色\r\n      const linkColors = [\"#e57373\", \"#81c784\", \"#64b5f6\", \"#fff176\"]; // 更淡的颜色\r\n\r\n      // 使用索引为节点和连接设置颜色\r\n      const nodesWithColors = sankeyData.nodes.map((node, index) => ({\r\n        ...node,\r\n        itemStyle: {\r\n          color: nodeColors[index % nodeColors.length], // 循环颜色\r\n        },\r\n      }));\r\n\r\n      const linksWithColors = sankeyData.links.map((link, index) => ({\r\n        ...link,\r\n        itemStyle: {\r\n          color: linkColors[index % linkColors.length], // 循环颜色\r\n          opacity: 0.6, // 设置连接的透明度使其更淡\r\n        },\r\n      }));\r\n\r\n      // 图例标题（4列标题）\r\n      const columnTitles = [\"始祖原居地\", \"始祖迁居地\", \"始迁祖原居地\", \"始迁祖迁居地\"];\r\n\r\n      // 动态生成标题位置（x 坐标按比例分布）\r\n      const graphicElements = columnTitles.map((title, index) => ({\r\n        type: \"text\",\r\n        left: `${10 + index * 20}%`, // 根据列的位置调整\r\n        top: \"5%\", // 标题的位置\r\n        style: {\r\n          text: title,\r\n          fontSize: 16,\r\n          fontWeight: \"bold\",\r\n          fill: \"#333\", // 标题颜色\r\n        },\r\n      }));\r\n\r\n      const option = {\r\n        title: {\r\n          text: \"家族迁徙路径\",\r\n          left: \"center\",\r\n        },\r\n        tooltip: {\r\n          trigger: \"item\",\r\n          formatter: params => {\r\n            if (params.dataType === \"node\") {\r\n              return `节点: ${params.name}<br>类别: ${params.data.category}`;\r\n            }\r\n            return `从: ${params.data.source}<br>到: ${params.data.target}<br>值: ${params.data.value}`;\r\n          },\r\n        },\r\n        series: [\r\n          {\r\n            type: \"sankey\",\r\n            data: sankeyData.nodes,\r\n            links: sankeyData.links,\r\n            emphasis: {\r\n              focus: \"adjacency\",\r\n            },\r\n            itemStyle: {\r\n              borderWidth: 0,\r\n              borderColor: \"#000\",\r\n            },\r\n            lineStyle: {\r\n              color: \"source\",\r\n              opacity: 0.6,\r\n            },\r\n            layoutIterations: 64, // 提高布局计算的次数，保证分布合理\r\n            nodeAlign: \"left\", // 节点左对齐\r\n            levels: [\r\n              { depth: 0, itemStyle: { color: \"#b71c1c\" } },\r\n              { depth: 1, itemStyle: { color: \"#388e3c\" } },\r\n              { depth: 2, itemStyle: { color: \"#1976d2\" } },\r\n              { depth: 3, itemStyle: { color: \"#fbc02d\" } },\r\n            ],\r\n          },\r\n        ],\r\n        graphic: [\r\n          {\r\n            type: \"text\",\r\n            left: \"10%\",\r\n            top: \"5%\",\r\n            style: {\r\n              text: \"始祖原居地\",\r\n              fontSize: 16,\r\n              fontWeight: \"bold\",\r\n            },\r\n          },\r\n          {\r\n            type: \"text\",\r\n            left: \"30%\",\r\n            top: \"5%\",\r\n            style: {\r\n              text: \"始祖迁居地\",\r\n              fontSize: 16,\r\n              fontWeight: \"bold\",\r\n            },\r\n          },\r\n          {\r\n            type: \"text\",\r\n            left: \"50%\",\r\n            top: \"5%\",\r\n            style: {\r\n              text: \"始迁祖原居地\",\r\n              fontSize: 16,\r\n              fontWeight: \"bold\",\r\n            },\r\n          },\r\n          {\r\n            type: \"text\",\r\n            left: \"70%\",\r\n            top: \"5%\",\r\n            style: {\r\n              text: \"始迁祖迁居地\",\r\n              fontSize: 16,\r\n              fontWeight: \"bold\",\r\n            },\r\n          },\r\n        ],\r\n      };\r\n\r\n      this.myChart.setOption(option);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.SangJiTu {\r\n  width: 100%;\r\n  text-align: center;\r\n}\r\n#SangJiTU {\r\n  width: 80%;\r\n  height: 800px;\r\n  margin: 0 auto;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}