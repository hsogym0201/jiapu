{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport * as echarts from 'echarts/core';\nimport { TitleComponent, TooltipComponent } from 'echarts/components';\nimport { SankeyChart } from 'echarts/charts';\nimport { CanvasRenderer } from 'echarts/renderers';\nimport jsonData from \"../assets/new.json\";\n\n// 注册必要的组件\necharts.use([TitleComponent, TooltipComponent, SankeyChart, CanvasRenderer]);\nexport default {\n  name: 'SangJiTu',\n  props: {\n    selectedProvince: String,\n    // 当前选中的省份\n    selectedSurname: String // 当前选中的姓氏\n  },\n  mounted() {\n    this.initChart();\n  },\n  methods: {\n    initChart() {\n      this.myChart = echarts.init(document.getElementById('main'));\n      this.setChartOption();\n    },\n    // 更新桑基图的数据\n    updateChartData(surname, province) {\n      // 获取对应姓氏的数据\n      const filteredData = jsonData.filter(item => item.居地 === province && item.姓氏 === surname);\n\n      // 格式化数据：四列数据\n      const nodes = [];\n      const links = [];\n      filteredData.forEach(item => {\n        const node1 = item.始祖原居地 || '未知';\n        const node2 = item.始祖迁居地 || '未知';\n        const node3 = item.始迁祖原居地 || '未知';\n        const node4 = item.始迁祖迁居地 || '未知';\n\n        // 添加节点\n        if (!nodes.find(node => node.name === node1)) nodes.push({\n          name: node1\n        });\n        if (!nodes.find(node => node.name === node2)) nodes.push({\n          name: node2\n        });\n        if (!nodes.find(node => node.name === node3)) nodes.push({\n          name: node3\n        });\n        if (!nodes.find(node => node.name === node4)) nodes.push({\n          name: node4\n        });\n\n        // 添加链接\n        links.push({\n          source: node1,\n          target: node2,\n          value: 1\n        });\n        links.push({\n          source: node2,\n          target: node3,\n          value: 1\n        });\n        links.push({\n          source: node3,\n          target: node4,\n          value: 1\n        });\n      });\n      this.myChart.setOption({\n        series: [{\n          type: 'sankey',\n          data: nodes,\n          links: links,\n          emphasis: {\n            focus: 'adjacency'\n          }\n        }]\n      });\n    },\n    // 更新桑基图的标题\n    updateTitle(newTitle) {\n      this.myChart.setOption({\n        title: {\n          text: newTitle\n        }\n      });\n    },\n    // 根据姓氏和省份更新桑基图\n    updateSankeyChart(surname, province) {\n      const title = `${province}省${surname}姓的家族迁徙`;\n      this.updateTitle(title);\n      this.updateChartData(surname, province);\n    }\n  }\n};","map":{"version":3,"names":["echarts","TitleComponent","TooltipComponent","SankeyChart","CanvasRenderer","jsonData","use","name","props","selectedProvince","String","selectedSurname","mounted","initChart","methods","myChart","init","document","getElementById","setChartOption","updateChartData","surname","province","filteredData","filter","item","居地","姓氏","nodes","links","forEach","node1","始祖原居地","node2","始祖迁居地","node3","始迁祖原居地","node4","始迁祖迁居地","find","node","push","source","target","value","setOption","series","type","data","emphasis","focus","updateTitle","newTitle","title","text","updateSankeyChart"],"sources":["D:\\project\\idea-project\\jiapudemo1\\jiapudemo1\\src\\components\\SangJiTu.vue"],"sourcesContent":["<template>\r\n  <div class=\"SangJiTu\">\r\n    <div id=\"main\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from 'echarts/core';\r\nimport { TitleComponent, TooltipComponent } from 'echarts/components';\r\nimport { SankeyChart } from 'echarts/charts';\r\nimport { CanvasRenderer } from 'echarts/renderers';\r\nimport jsonData from \"../assets/new.json\";\r\n\r\n// 注册必要的组件\r\necharts.use([TitleComponent, TooltipComponent, SankeyChart, CanvasRenderer]);\r\n\r\nexport default {\r\n  name: 'SangJiTu',\r\n  props: {\r\n    selectedProvince: String,  // 当前选中的省份\r\n    selectedSurname: String,   // 当前选中的姓氏\r\n  },\r\n  mounted() {\r\n    this.initChart();\r\n  },\r\n  methods: {\r\n    initChart() {\r\n      this.myChart = echarts.init(document.getElementById('main'));\r\n      this.setChartOption();\r\n    },\r\n\r\n    // 更新桑基图的数据\r\n    updateChartData(surname, province) {\r\n      // 获取对应姓氏的数据\r\n      const filteredData = jsonData.filter(item => item.居地 === province && item.姓氏 === surname);\r\n\r\n      // 格式化数据：四列数据\r\n      const nodes = [];\r\n      const links = [];\r\n      filteredData.forEach(item => {\r\n        const node1 = item.始祖原居地 || '未知';\r\n        const node2 = item.始祖迁居地 || '未知';\r\n        const node3 = item.始迁祖原居地 || '未知';\r\n        const node4 = item.始迁祖迁居地 || '未知';\r\n\r\n        // 添加节点\r\n        if (!nodes.find(node => node.name === node1)) nodes.push({ name: node1 });\r\n        if (!nodes.find(node => node.name === node2)) nodes.push({ name: node2 });\r\n        if (!nodes.find(node => node.name === node3)) nodes.push({ name: node3 });\r\n        if (!nodes.find(node => node.name === node4)) nodes.push({ name: node4 });\r\n\r\n        // 添加链接\r\n        links.push({ source: node1, target: node2, value: 1 });\r\n        links.push({ source: node2, target: node3, value: 1 });\r\n        links.push({ source: node3, target: node4, value: 1 });\r\n      });\r\n\r\n      this.myChart.setOption({\r\n        series: [\r\n          {\r\n            type: 'sankey',\r\n            data: nodes,\r\n            links: links,\r\n            emphasis: {\r\n              focus: 'adjacency'\r\n            }\r\n          }\r\n        ]\r\n      });\r\n    },\r\n\r\n    // 更新桑基图的标题\r\n    updateTitle(newTitle) {\r\n      this.myChart.setOption({\r\n        title: {\r\n          text: newTitle,\r\n        }\r\n      });\r\n    },\r\n\r\n    // 根据姓氏和省份更新桑基图\r\n    updateSankeyChart(surname, province) {\r\n      const title = `${province}省${surname}姓的家族迁徙`;\r\n      this.updateTitle(title);\r\n      this.updateChartData(surname, province);\r\n    }\r\n  },\r\n};\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.SangJiTu {\r\n  width: 100%;\r\n  text-align: center;\r\n}\r\n\r\n#main {\r\n  width: 80%;\r\n  height: 600px;\r\n  margin: 0 auto;\r\n  background: #fff;\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}